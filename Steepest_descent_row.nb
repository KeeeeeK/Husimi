(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14357,        384]
NotebookOptionsPosition[     13185,        356]
NotebookOutlinePosition[     13539,        372]
CellTagsIndexPosition[     13496,        369]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"zk", " ", "=", 
   RowBox[{
    FractionBox["I", "2"], "*", 
    RowBox[{"(", " ", 
     RowBox[{"L1", " ", "-", " ", "L2", "  ", "+", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          SuperscriptBox["L1", "n"]], 
         RowBox[{"Sum", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "k"], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}], "!"}]], 
            RowBox[{"Abs", "@", 
             RowBox[{"StirlingS1", "[", 
              RowBox[{"n", ",", " ", 
               RowBox[{"k", "+", "1"}]}], "]"}]}], " ", 
            SuperscriptBox["L2", 
             RowBox[{"n", "-", "k"}]]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", " ", "0", ",", " ", 
             RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"n", ",", " ", "0", ",", " ", "nmax"}], "}"}]}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"L1", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"Log", "[", "z", "]"}], "+", 
       RowBox[{"2", "\[Pi]", " ", "I", " ", "k"}]}]}], ",", " ", 
     RowBox[{"L2", "\[Rule]", " ", 
      RowBox[{"Log", "[", 
       RowBox[{
        RowBox[{"Log", "[", "z", "]"}], "+", 
        RowBox[{"2", "\[Pi]", " ", "I", " ", "k"}]}], "]"}]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.873137651003529*^9, 3.873137679645709*^9}, {
  3.873482269205511*^9, 3.87348228412728*^9}, {3.8735631105429897`*^9, 
  3.873563217903289*^9}, {3.873563289114908*^9, 3.87356340651751*^9}, {
  3.873563522492221*^9, 3.873563559906727*^9}, {3.8735666093733873`*^9, 
  3.873566669368325*^9}, {3.8735667137269993`*^9, 3.873566729356429*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"98129b9f-f686-4701-8987-189f2dd341a3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "zk", " ", 
    "\:0434\:0435\:0439\:0441\:0442\:0432\:0438\:0442\:0435\:043b\:044c\:043d\
\:043e", " ", "\:0440\:0430\:0431\:043e\:0442\:0430\:0435\:0442"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", 
      RowBox[{"2", "I"}]]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], "I", " ", "*", "zk"}], "/.", 
       RowBox[{"{", 
        RowBox[{"nmax", "\[Rule]", "4"}], "}"}]}], "//", "Simplify"}], 
     ")"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"zk", "/.", 
       RowBox[{"{", 
        RowBox[{"nmax", "\[Rule]", "4"}], "}"}]}], "/.", " ", "rules"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"z", "\[Rule]", 
        RowBox[{"1", "+", "I"}]}], ",", " ", 
       RowBox[{"k", "\[Rule]", "10"}]}], "}"}]}], "//", "N"}]}]}]], "Input",
 CellChangeTimes->{{3.873563574843539*^9, 3.8735635925557547`*^9}, {
  3.873563650372711*^9, 3.873563650440002*^9}, {3.873566673775063*^9, 
  3.8735668098213367`*^9}, {3.8735668475861473`*^9, 3.873566897819674*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"0d8c7872-74d7-48be-960a-026f15f95ffe"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
  RowBox[{"(", 
   RowBox[{"L1", "-", "L2", "+", 
    FractionBox["L2", "L1"], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "L2"}], ")"}], " ", "L2"}], 
     RowBox[{"2", " ", 
      SuperscriptBox["L1", "2"]}]], "+", 
    FractionBox[
     RowBox[{"L2", " ", 
      RowBox[{"(", 
       RowBox[{"6", "-", 
        RowBox[{"9", " ", "L2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["L2", "2"]}]}], ")"}]}], 
     RowBox[{"6", " ", 
      SuperscriptBox["L1", "3"]}]], "+", 
    FractionBox[
     RowBox[{"L2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "12"}], "+", 
        RowBox[{"36", " ", "L2"}], "-", 
        RowBox[{"22", " ", 
         SuperscriptBox["L2", "2"]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["L2", "3"]}]}], ")"}]}], 
     RowBox[{"12", " ", 
      SuperscriptBox["L1", "4"]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.873563586498644*^9, 3.8735635929993553`*^9}, 
   3.873563650922628*^9, {3.87356668122836*^9, 3.8735666967495317`*^9}, {
   3.873566735648847*^9, 3.8735668124560127`*^9}, {3.873566851150093*^9, 
   3.873566855102551*^9}, {3.873566885563147*^9, 3.873566898489132*^9}},
 CellLabel->"Out[49]=",ExpressionUUID->"8e0a4bcd-9bf3-4710-b978-4e491ceee0e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "30.992756603475442`"}], "-", 
  RowBox[{"1.891092562607559`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{{3.873563586498644*^9, 3.8735635929993553`*^9}, 
   3.873563650922628*^9, {3.87356668122836*^9, 3.8735666967495317`*^9}, {
   3.873566735648847*^9, 3.8735668124560127`*^9}, {3.873566851150093*^9, 
   3.873566855102551*^9}, {3.873566885563147*^9, 3.8735668984906263`*^9}},
 CellLabel->"Out[50]=",ExpressionUUID->"cea51b15-e8dc-453b-a249-6d178fd4fdf7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", " ", "d"}], "}"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        FractionBox[
         SuperscriptBox["t", "j"], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"j", "+", "2"}], ")"}], "!"}]], ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "1", ",", " ", "Infinity"}], "}"}]}], "]"}], "//",
       "NumeratorDenominator"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"n", "/", "2"}], "//", "Simplify"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"d", "/", "2"}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.87417688894341*^9, 3.874176935922385*^9}, {
  3.874177522426112*^9, 3.8741776591505327`*^9}, {3.874334226204698*^9, 
  3.874334236525674*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"399f84d3-72dd-44c7-959d-7bed333f46aa"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   SuperscriptBox["\[ExponentialE]", "t"], "-", "t", "-", 
   FractionBox[
    SuperscriptBox["t", "2"], "2"]}], 
  SuperscriptBox["t", "2"]]], "Output",
 CellChangeTimes->{{3.874176918734721*^9, 3.874176936343277*^9}, {
  3.874177531468017*^9, 3.874177579529179*^9}, {3.8741776345143757`*^9, 
  3.874177659885008*^9}, {3.874334226830579*^9, 3.8743342368671417`*^9}},
 CellLabel->"Out[96]=",ExpressionUUID->"e62db060-8a55-429d-bd81-50e10dd97392"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"nmax", ",", " ", "kmax"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"10", " ", ",", " ", "10"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"seri", " ", "=", " ", 
   RowBox[{"Normal", "@", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{"u", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", "t", "]"}], "-", "1", "-", "t", "-", 
           RowBox[{
            SuperscriptBox["t", "2"], "/", "2"}]}], ")"}], "/", 
         SuperscriptBox["t", "2"]}]}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"u", ",", " ", "0", ",", " ", "nmax"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", " ", "0", ",", " ", "kmax"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{"table", " ", "=", " ", 
    RowBox[{"CoefficientList", "[", 
     RowBox[{"seri", ",", " ", 
      RowBox[{"{", 
       RowBox[{"t", ",", " ", "u"}], "}"}]}], "]"}]}], 
   ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"table", "[", 
    RowBox[{"[", 
     RowBox[{"n", "+", "1"}], "]"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"k", "+", "1"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coefs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     FractionBox[
      RowBox[{"BellY", "[", 
       RowBox[{"nt", ",", " ", "kt", ",", "  ", 
        RowBox[{"Table", "[", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"i", "+", "2"}], ")"}]}]], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"nt", "-", "kt", "+", "1"}]}], "}"}]}], "]"}]}], "]"}], 
      RowBox[{"nt", "!"}]], ",", 
     RowBox[{"{", 
      RowBox[{"nt", ",", " ", "0", ",", " ", "nmax"}], "}"}], " ", ",", " ", 
     RowBox[{"{", 
      RowBox[{"kt", ",", " ", "0", ",", " ", "kmax"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"table", "\[Equal]", "coefs"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S3", " ", "=", " ", 
   RowBox[{"table", " ", "*", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"kt", "+", 
         RowBox[{"2", "nt"}]}], ")"}], "!"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"nt", ",", " ", "0", ",", " ", "nmax"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kt", ",", " ", "0", ",", " ", "kmax"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"S3", "//", "MatrixForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.874436382623415*^9, 3.874436642736258*^9}, {
  3.874436707969756*^9, 3.8744367092705793`*^9}, {3.8744371960192833`*^9, 
  3.874437435977735*^9}, {3.874437483736185*^9, 3.874437509592594*^9}, {
  3.87443767249092*^9, 3.874437672627858*^9}, {3.874437813191123*^9, 
  3.874437842770094*^9}, {3.874437891398569*^9, 3.8744380594905577`*^9}},
 CellLabel->
  "In[198]:=",ExpressionUUID->"21fa96ba-4da3-4021-8c44-161f3b105501"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.874437327282301*^9, 3.874437383026437*^9}, 
   3.874437436520543*^9, 3.87443751012854*^9, 3.874437673479702*^9, {
   3.874437816636421*^9, 3.874437843100878*^9}, {3.874437920870805*^9, 
   3.87443795424411*^9}, 3.8744379932242727`*^9, {3.874438051864554*^9, 
   3.8744380599273453`*^9}, 3.874438209617627*^9},
 CellLabel->
  "Out[203]=",ExpressionUUID->"97dadb02-d50a-4024-851c-85d3f48b5347"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "5", "10", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "42", "280", "280", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "504", "8190", "23100", "15400", "0", "0", "0", "0", "0", "0"},
     {"0", "7920", "277200", "1621620", "2802800", "1401400", "0", "0", "0", 
      "0", "0"},
     {"0", "154440", "10954944", "116666550", "386786400", "476476000", 
      "190590400", "0", "0", "0", "0"},
     {"0", "3603600", "501621120", "9042153120", "50601751200", 
      "114068354400", "108636528000", "36212176000", "0", "0", "0"},
     {"0", "98017920", "26317811520", "766818692640", "6739926593400", 
      "24524696196000", "41406812647200", "32065881848000", "9161680528000", 
      "0", "0"},
     {"0", "3047466240", "1564366003200", "71413308046080", "941063923800000",
       "5150353229821800", "13621586609030400", "18277552653360000", 
      "11910184686400000", "2977546171600000", "0"},
     {"0", "106661318400", "104253820070400", "7294804886809440", 
      "139527263900344320", "1097220038184270000", "4240770134901300000", 
      "8722721509702200000", "9679407094637280000", "5439976855513200000", 
      "1208883745669600000"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.874437327282301*^9, 3.874437383026437*^9}, 
   3.874437436520543*^9, 3.87443751012854*^9, 3.874437673479702*^9, {
   3.874437816636421*^9, 3.874437843100878*^9}, {3.874437920870805*^9, 
   3.87443795424411*^9}, 3.8744379932242727`*^9, {3.874438051864554*^9, 
   3.8744380599273453`*^9}, 3.874438209620085*^9},
 CellLabel->
  "Out[205]//MatrixForm=",ExpressionUUID->"c6d93853-b04a-467e-8c32-\
206701c56463"]
}, Open  ]]
},
WindowSize->{1920, 1027},
WindowMargins->{{0, Automatic}, {Automatic, 26}},
Magnification->2.,
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2088, 53, 470, "Input",ExpressionUUID->"98129b9f-f686-4701-8987-189f2dd341a3"],
Cell[CellGroupData[{
Cell[2671, 77, 1246, 35, 276, "Input",ExpressionUUID->"0d8c7872-74d7-48be-960a-026f15f95ffe"],
Cell[3920, 114, 1381, 38, 141, "Output",ExpressionUUID->"8e0a4bcd-9bf3-4710-b978-4e491ceee0e2"],
Cell[5304, 154, 508, 8, 96, "Output",ExpressionUUID->"cea51b15-e8dc-453b-a249-6d178fd4fdf7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5849, 167, 972, 27, 294, "Input",ExpressionUUID->"399f84d3-72dd-44c7-959d-7bed333f46aa"],
Cell[6824, 196, 514, 11, 141, "Output",ExpressionUUID->"e62db060-8a55-429d-bd81-50e10dd97392"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7375, 212, 3177, 88, 689, "Input",ExpressionUUID->"21fa96ba-4da3-4021-8c44-161f3b105501"],
Cell[10555, 302, 446, 7, 96, "Output",ExpressionUUID->"97dadb02-d50a-4024-851c-85d3f48b5347"],
Cell[11004, 311, 2165, 42, 506, "Output",ExpressionUUID->"c6d93853-b04a-467e-8c32-206701c56463"]
}, Open  ]]
}
]
*)

